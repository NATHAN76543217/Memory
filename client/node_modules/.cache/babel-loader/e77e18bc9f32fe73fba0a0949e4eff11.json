{"ast":null,"code":"import axios from \"axios\";\nconst headers = {\n  \"Content-Type\": \"application/json\"\n};\nconst burl = \"http://localhost:8800\";\n\nfunction login(name, password) {\n  //create a POST http request\n  return axios.post(`${burl}/login`, {\n    name,\n    password\n  }, {\n    headers: headers\n  });\n}\n\nfunction signup(send) {\n  return axios.post(`${burl}/signup`, send, {\n    headers: headers\n  });\n}\n\nfunction isAuth() {\n  const token = localStorage.getItem(\"token\");\n  if (token == null) return false;\n  console.log(\"token founded\");\n  const res = axios.get(`${burl}/isAuth`, {\n    headers: headers,\n    params: {\n      token: token\n    }\n  }).then(res => {\n    return res.data.isAuth;\n  }).catch(error => {\n    if (error.response && error.response.status === 408) {\n      console.log(\"Token expired\");\n      logout();\n      return false;\n    }\n  });\n  ;\n  console.log(\"IsAuth: \" + res);\n  return res;\n}\n\nfunction logout() {\n  localStorage.clear();\n  window.location = \"/\";\n}\n\nfunction getToken() {\n  const tk = localStorage.getItem(\"token\");\n  return tk;\n}\n\nfunction updateToken() {\n  return axios.put(`${burl}/updateToken`, {\n    token: getToken()\n  }, {\n    headers: headers\n  }).then(res => console.log(\"UPDATAE\") && console.log(res) && localStorage.setItem(\"token\", res.data.token)).catch(error => {\n    if (error.response && error.response.status === 408) {\n      console.log(\"Token expired\");\n      logout();\n    }\n  });\n}\n\nfunction getUserInfo() {\n  if (this.isAuth) {\n    let token = this.getToken();\n    return axios.get(`${burl}/info`, {\n      headers: headers,\n      params: {\n        token: token\n      }\n    }).catch(error => {\n      if (error.response && error.response.status === 408) {\n        console.log(\"Token expired\");\n        logout();\n      }\n    });\n  }\n\n  return null;\n}\n\nfunction looseTheGame() {\n  return axios.post(`${burl}/loose`, {}, {\n    headers: headers\n  });\n}\n\nfunction sendScore(nb_card, result, time_elapsed) {\n  localStorage.setItem(\"last\", result);\n  console.log(\"set result to:\" + result);\n  window.location = \"/endgame\";\n  return axios.put(`${burl}/result`, {\n    token: this.getToken(),\n    result: result,\n    score: time_elapsed,\n    nb_card: nb_card\n  }, {\n    headers: headers\n  }).catch(error => console.error(error));\n}\n\nfunction getScores(scope, nb_card) {\n  if (this.isAuth) {\n    const token = this.getToken();\n    return axios.get(`${burl}/scores`, {\n      headers: headers,\n      params: {\n        token: token,\n        nb_card: nb_card\n      }\n    }).then(res => {\n      return res.data.scores;\n    }).catch(err => {\n      if (err.response && err.response.status === 500) return null;else console.error(err);\n    });\n  }\n}\n\nconst API = {\n  signup,\n  login,\n  logout,\n  isAuth,\n  getToken,\n  updateToken,\n  getUserInfo,\n  looseTheGame,\n  sendScore,\n  getScores\n};\nexport default API;","map":{"version":3,"sources":["/Users/sebastienlecaille/programmation/web/memory/client/src/utils/API.js"],"names":["axios","headers","burl","login","name","password","post","signup","send","isAuth","token","localStorage","getItem","console","log","res","get","params","then","data","catch","error","response","status","logout","clear","window","location","getToken","tk","updateToken","put","setItem","getUserInfo","looseTheGame","sendScore","nb_card","result","time_elapsed","score","getScores","scope","scores","err","API"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nconst headers = {\n\t\"Content-Type\": \"application/json\"\n};\nconst burl = \"http://localhost:8800\";\n\nfunction login(name, password) {\n\t//create a POST http request\n\treturn axios.post(\n\t\t`${burl}/login`,{name, password},{\n\t\t\theaders: headers\n\t\t}\n\t);\n}\nfunction signup(send) {\n\treturn axios.post(`${burl}/signup`, send, { headers: headers });\n}\n\nfunction isAuth() {\n\tconst token = localStorage.getItem(\"token\");\n\tif (token == null)\n\t\treturn false;\n\tconsole.log(\"token founded\");\n\tconst res = axios.get(`${burl}/isAuth`, {headers:headers, params:{token:token}})\n\t.then((res) => {return res.data.isAuth})\n\t.catch(error => {\n\t\tif (error.response && error.response.status === 408)\n\t\t{\n\t\t\tconsole.log(\"Token expired\");\n\t\t\tlogout();\n\t\t\treturn false\n\t\t}\n\t});;\n\tconsole.log(\"IsAuth: \" + res);\n\treturn res;\n}\nfunction logout() {\n\tlocalStorage.clear();\n\twindow.location = \"/\";\n}\nfunction getToken() {\n\tconst tk = localStorage.getItem(\"token\");\n\treturn tk;\n}\nfunction updateToken()\n{\n\treturn axios.put(`${burl}/updateToken`, {token:getToken()}, {headers:headers})\n\t.then((res)=> console.log(\"UPDATAE\") && console.log(res) && localStorage.setItem(\"token\", res.data.token))\n\t.catch(error=> {\n\t\tif (error.response && error.response.status === 408)\n\t\t{\n\t\t\tconsole.log(\"Token expired\");\n\t\t\tlogout();\n\t\t}\t\t\n\t});\n}\nfunction getUserInfo() {\n\tif (this.isAuth){\n\t\tlet token = this.getToken();\n\t\treturn axios.get(`${burl}/info`, {headers: headers, params: {token : token} }).catch(error => {\n\t\t\tif (error.response && error.response.status === 408)\n\t\t\t{\n\t\t\t\tconsole.log(\"Token expired\");\n\t\t\t\tlogout();\n\t\t\t}\n\t\t});\n\t}\n\treturn null;\n}\nfunction looseTheGame()\n{\n\treturn axios.post(`${burl}/loose`, {}, {headers: headers});\n}\n\nfunction sendScore(nb_card, result, time_elapsed)\n{\n\tlocalStorage.setItem(\"last\", result);\n\tconsole.log(\"set result to:\" + result);\n\twindow.location = \"/endgame\"\n\treturn axios.put(`${burl}/result`, {token: this.getToken(), result: result, score: time_elapsed, nb_card: nb_card}, {headers: headers}).catch(error => console.error(error))\n}\nfunction getScores(scope, nb_card)\n{\n\tif (this.isAuth){\n\t\tconst token = this.getToken();\n\t\treturn axios.get(`${burl}/scores`, {headers: headers, params: {token: token, nb_card: nb_card}})\n\t\t\t.then((res) => {return res.data.scores})\n\t\t\t.catch(err => {\n\t\t\t\tif (err.response && err.response.status === 500)\n\t\t\t\t\treturn null\n\t\t\t\telse\n\t\t\t\t\tconsole.error(err);\n\t\t\t});\n\t}\n}\n\n\nconst API = {\n\tsignup,\n\tlogin,\n\tlogout,\n\tisAuth,\n\tgetToken,\n\tupdateToken,\n\tgetUserInfo,\n\tlooseTheGame,\n\tsendScore,\n\tgetScores\n}\nexport default API;"]},"metadata":{},"sourceType":"module"}