{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/sebastienlecaille/programmation/web/memory/src/Memory.js\";\nimport './Memory.css';\nimport Board from './Board';\nimport React from 'react';\nimport img_loader from './images';\nimport PropTypes from 'prop-types';\n\nclass Memory extends React.Component {\n  constructor(props) {\n    super(props);\n    this.name = \"Memory\";\n    this.state = {\n      card_list: this.load_cards(),\n      flipped: []\n    };\n    this.clickOnCard.bind(this);\n  }\n\n  test_match() {\n    console.log(\"flipped length =\" + this.state.flipped.length);\n    console.log(\"flipped :\" + JSON.parse(JSON.stringify(this.state.flipped)));\n    console.log(\"ret: \" + this.state.flipped[1]);\n\n    if (this.getFruit(this.state.flipped[0]).id === this.getFruit(this.state.flipped[1]).id) {\n      console.log(\"Match!\");\n      return true;\n    }\n\n    console.log(\"No__ match\");\n    return false;\n  }\n\n  updateFruit(fruit) {\n    //récup une copie de liste de fruit\n    const lst = [...this.state.card_list]; //récupere l'index du fruit à changer\n\n    const ndx = this.getFruitIndex(fruit); //met a jour le fruit dans la liste\n\n    lst[ndx] = fruit; //update state\n\n    this.setState({\n      card_list: lst\n    });\n  }\n\n  getFruitIndex(fruit) {\n    return this.state.card_list.findIndex(f => f.k === fruit.k);\n  }\n\n  getFruit(ndx) {\n    console.log(\"--\" + ndx + \" - \" + this.state.card_list[ndx]);\n    return this.state.card_list[ndx];\n  }\n\n  clickOnCard(fruit) {\n    if (fruit.visible) return;\n    console.log(\"set visible: key=\" + fruit.k + \" et id=\" + fruit.id);\n    fruit.visible = true;\n    const flip_cnt = this.flipped.length; //save flipped card\n\n    this.setState({\n      flipped: [...this.state.flipped, this.getFruitIndex(fruit)]\n    }, () => console.log(\"flipped :\" + this.state.flipped));\n    this.updateFruit(fruit);\n    console.log(\"after flipped length =\" + this.state.flipped.length);\n\n    if (flip_cnt + 1 === 2) {\n      if (this.test_match() === true) {} else {\n        //cache les cartes visibles\n        this.state.flipped.forEach(ndx => {\n          console.log(\"hide ndx:\" + ndx);\n          const fruit = this.getFruit(ndx);\n          fruit.visible = false;\n          this.updateFruit(fruit);\n        });\n        this.setState({\n          flipped: []\n        });\n      }\n    }\n  }\n\n  load_cards() {\n    const fruits = img_loader();\n    let dup = [];\n    fruits.forEach(f => dup.push({ ...f\n    }));\n    dup.forEach(elem => elem.k = elem.id + dup.length);\n    const cards = [...fruits, ...dup];\n    console.log(\"set a donne of \" + cards.length + \" cards\");\n    console.log(cards);\n    return cards; //\t\treturn cards;\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"this.name\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game_field\",\n      children: /*#__PURE__*/_jsxDEV(Board, {\n        donne: this.state.card_list,\n        onClick: i => this.clickOnCard(i)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 3\n    }, this);\n  }\n\n}\n\nexport default Memory;","map":{"version":3,"sources":["/Users/sebastienlecaille/programmation/web/memory/src/Memory.js"],"names":["Board","React","img_loader","PropTypes","Memory","Component","constructor","props","name","state","card_list","load_cards","flipped","clickOnCard","bind","test_match","console","log","length","JSON","parse","stringify","getFruit","id","updateFruit","fruit","lst","ndx","getFruitIndex","setState","findIndex","f","k","visible","flip_cnt","forEach","fruits","dup","push","elem","cards","render","i"],"mappings":"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","sourcesContent":["import './Memory.css';\nimport Board from './Board'\nimport React from 'react';\nimport img_loader from './images'\nimport PropTypes from 'prop-types'\n\n\n\nclass Memory extends React.Component\n{\n\tconstructor(props)\n\t{\n\t\tsuper(props);\n\t\tthis.name = \"Memory\"\n\t\tthis.state = {\n\t\t\tcard_list: this.load_cards(),\n\t\t\tflipped: [],\n\t\t};\n\t\tthis.clickOnCard.bind(this);\n\t}\n\ttest_match()\n\t{\n\t\tconsole.log(\"flipped length =\" + this.state.flipped.length);\n        console.log(\"flipped :\" + JSON.parse(JSON.stringify(this.state.flipped)));\n\t\tconsole.log(\"ret: \" + this.state.flipped[1]);\n\t\tif (this.getFruit(this.state.flipped[0]).id === this.getFruit(this.state.flipped[1]).id)\n\t\t{\n\t\t\tconsole.log(\"Match!\");\n\t\t\treturn true;\n\t\t}\n\t\tconsole.log(\"No__ match\");\n\t\treturn false;\n\t\t\n\t}\n\tupdateFruit(fruit)\n\t{\n\t\t//récup une copie de liste de fruit\n\t\tconst lst = [...this.state.card_list];\n\t\t//récupere l'index du fruit à changer\n\t\tconst ndx = this.getFruitIndex(fruit);\n\t\t//met a jour le fruit dans la liste\n\t\tlst[ndx] = fruit;\n\t\t//update state\n\t\tthis.setState({card_list: lst})\n\t}\n\n\tgetFruitIndex(fruit)\n\t{\n\t\treturn this.state.card_list.findIndex(f => f.k === fruit.k);\n\t}\n\n\tgetFruit(ndx)\n\t{\n\t\tconsole.log(\"--\" + ndx + \" - \" + this.state.card_list[ndx]);\n\t\treturn this.state.card_list[ndx];\n\t}\n\n\tclickOnCard(fruit)\n\t{\n\t\tif (fruit.visible)\n\t\t\treturn;\n\t\tconsole.log(\"set visible: key=\" + fruit.k + \" et id=\" + fruit.id);\n\t\tfruit.visible = true;\n\t\tconst flip_cnt = this.flipped.length;\n\t\t//save flipped card\n\t\tthis.setState({\n\t\t\tflipped: [...this.state.flipped, this.getFruitIndex(fruit)],\n\t\t}, ()=> console.log(\"flipped :\" + this.state.flipped));\n\t\tthis.updateFruit(fruit);\n\t\tconsole.log(\"after flipped length =\" + this.state.flipped.length);\n\t\tif (flip_cnt + 1 === 2)\n\t\t{\n\t\t\tif (this.test_match() === true)\n\t\t\t{\n\t\t\t\t\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//cache les cartes visibles\n\t\t\t\tthis.state.flipped.forEach((ndx)=> {\n\t\t\t\t\tconsole.log(\"hide ndx:\" + ndx);\n\t\t\t\t\tconst fruit = this.getFruit(ndx);\n\t\t\t\t\tfruit.visible = false;\n\t\t\t\t\tthis.updateFruit(fruit);\n\t\t\t\t});\n\t\t\t\tthis.setState({flipped: []});\n\n\t\t\t}\n\t\t}\n\t}\n\n\nload_cards()\n\t{\n\t\tconst fruits = img_loader();\n\t\tlet dup = [];\n\t\tfruits.forEach(f => \n\t\t\tdup.push({...f}));\n\t\tdup.forEach(elem => elem.k = elem.id + dup.length);\n\t\tconst cards = [...fruits, ...dup];\n\t\tconsole.log(\"set a donne of \" + cards.length + \" cards\");\n\t\tconsole.log(cards);\n\t\treturn cards;\n//\t\treturn cards;\n}\n\n  render(){\n\n\treturn (\n\t\t<h1>this.name</h1>,\n\t\t<div className=\"game_field\">\n    \t    \t<Board donne={this.state.card_list} onClick={(i) => this.clickOnCard(i)}/>\n\t\t</div>\n\t\t)}\n}\nexport default Memory;"]},"metadata":{},"sourceType":"module"}