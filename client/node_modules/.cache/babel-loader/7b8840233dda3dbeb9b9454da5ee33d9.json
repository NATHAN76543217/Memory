{"ast":null,"code":"import axios from \"axios\";\nconst headers = {\n  \"Content-Type\": \"application/json\"\n};\nconst burl = \"http://localhost:8800\";\n\nfunction login(name, password) {\n  //create a POST http request\n  return axios.post(`${burl}/login`, {\n    name,\n    password\n  }, {\n    headers: headers\n  });\n}\n\nfunction signup(send) {\n  return axios.post(`${burl}/signup`, send, {\n    headers: headers\n  });\n}\n\nfunction isAuth() {\n  const ret = localStorage.getItem(\"token\") !== null;\n  console.log(\"IsAuth: \" + ret);\n  return ret;\n}\n\nfunction logout() {\n  localStorage.clear();\n  window.location = \"/\";\n}\n\nfunction getToken() {\n  const tk = localStorage.getItem(\"token\");\n  return tk;\n}\n\nfunction getUserInfo() {\n  if (this.isAuth) {\n    let token = this.getToken();\n    return axios.get(`${burl}/info`, {\n      headers: headers,\n      params: {\n        token: token\n      }\n    }).catch(error => {\n      if (error.response && error.response.status === 408) {\n        console.log(\"Token expired\");\n        logout();\n      }\n    });\n  }\n\n  return null;\n}\n\nfunction looseTheGame() {\n  return axios.post(`${burl}/loose`, {}, {\n    headers: headers\n  });\n}\n\nfunction sendScore(result) {\n  localStorage.setItem(\"last\", result);\n  console.log(\"set result to:\" + result);\n  window.location = \"/endgame\";\n  return axios.put(`${burl}/result`, {\n    token: this.getToken(),\n    result: result\n  }, {\n    headers: headers\n  });\n}\n\nfunction getScores(scope) {\n  const token = this.getToken();\n  return axios.get(`${burl}/scores`, {\n    headers: headers,\n    params: {\n      token: token,\n      scope: scope\n    }\n  }).then(res => res.data).catch(err => console.log(\"ERROR= \" + err));\n}\n\nconst API = {\n  signup,\n  login,\n  logout,\n  isAuth,\n  getToken,\n  getUserInfo,\n  looseTheGame,\n  sendScore,\n  getScores\n};\nexport default API;","map":{"version":3,"sources":["/Users/sebastienlecaille/programmation/web/memory/client/src/utils/API.js"],"names":["axios","headers","burl","login","name","password","post","signup","send","isAuth","ret","localStorage","getItem","console","log","logout","clear","window","location","getToken","tk","getUserInfo","token","get","params","catch","error","response","status","looseTheGame","sendScore","result","setItem","put","getScores","scope","then","res","data","err","API"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nconst headers = {\n\t\"Content-Type\": \"application/json\"\n};\nconst burl = \"http://localhost:8800\";\n\nfunction login(name, password) {\n\t//create a POST http request\n\treturn axios.post(\n\t\t`${burl}/login`,\n\t\t{\n\t\t\tname,\n\t\t\tpassword\n\t\t},\n\t\t{\n\t\t\theaders: headers\n\t\t}\n\t);\n}\nfunction signup(send) {\n\treturn axios.post(`${burl}/signup`, send, { headers: headers });\n}\n\nfunction isAuth() {\n\tconst ret = localStorage.getItem(\"token\") !== null ;\n\tconsole.log(\"IsAuth: \" + ret);\n\treturn ret;\n}\nfunction logout() {\n\tlocalStorage.clear();\n\twindow.location = \"/\";\n}\nfunction getToken() {\n\tconst tk = localStorage.getItem(\"token\");\n\treturn tk;\n}\nfunction getUserInfo() {\n\tif (this.isAuth){\n\t\tlet token = this.getToken();\n\t\treturn axios.get(`${burl}/info`, {headers: headers, params: {token : token} }).catch(error => {\n\t\t\tif (error.response && error.response.status === 408)\n\t\t\t{\n\t\t\t\tconsole.log(\"Token expired\");\n\t\t\t\tlogout();\n\t\t\t}\n\t\t});\n\t}\n\treturn null;\n}\nfunction looseTheGame()\n{\n\treturn axios.post(`${burl}/loose`, {}, {headers: headers});\n}\n\nfunction sendScore(result)\n{\n\tlocalStorage.setItem(\"last\", result);\n\tconsole.log(\"set result to:\" + result);\n\twindow.location = \"/endgame\"\n\treturn axios.put(`${burl}/result`, {token: this.getToken(), result: result}, {headers: headers})\n}\nfunction getScores(scope)\n{\n\tconst token = this.getToken();\n\treturn axios.get(`${burl}/scores`, {headers: headers, params: {token: token, scope: scope,}}).then((res) => res.data).catch(err => console.log(\"ERROR= \" + err));\n}\n\nconst API = {\n\tsignup,\n\tlogin,\n\tlogout,\n\tisAuth,\n\tgetToken,\n\tgetUserInfo,\n\tlooseTheGame,\n\tsendScore,\n\tgetScores\n}\nexport default API;"]},"metadata":{},"sourceType":"module"}